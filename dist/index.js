!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PostMessageHandler=t():e.PostMessageHandler=t()}(self,(()=>(()=>{"use strict";var e={574:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});var i=s(873),r=s(411);t.default=function(e,t,s,n){if((0,i.default)(e,"addEventListener"))return e.addEventListener(t,s,n),function(){e.removeEventListener(t,s,n)};if((0,i.default)(e,"attachEvent")){var o="on"+t;return e.attachEvent(o,s),function(){e.detachEvent(o,s)}}return r.default}},411:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){}},873:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(null!=e)try{return t in e}catch(s){return void 0!==e[t]}return!1}}},t={};function s(i){var r=t[i];if(void 0!==r)return r.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,s),n.exports}var i={};return(()=>{var e=i,t=s(574),r=s(411),n=function(){function e(e,t,s){var i=this;if(this.messageListener=[],this.listenerRegistered=!1,this.isWindow=t.self===t&&t.window===t&&"object"==typeof window.document,this.isWindow&&"string"!=typeof s)throw new Error("`target` is `window` like which requires an `targetOrigin`, but no `targetOrigin` is set");this.targetOrigin=s,this.secret=e,this.target=t,this.eventCallback=function(e){i.handleMessage(e)}}return e.prototype.subscribe=function(e){var s=this;return this.listenerRegistered||(this.listenerRegistered=!0,this.removeMessageListener=(0,t.default)(this.target,"message",this.eventCallback,!1)),"function"==typeof e?(this.messageListener.push(e),function(){s.unsubscribe(e)}):r.default},e.prototype.unsubscribe=function(e){var t=this.messageListener.indexOf(e);-1!==t&&this.messageListener.splice(t,1),this.listenerRegistered&&0===this.messageListener.length&&(this.listenerRegistered=!1,this.removeMessageListener())},e.prototype.send=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return this.isWindow?this.target.postMessage(this.secret+JSON.stringify(e),this.targetOrigin):this.target.postMessage(this.secret+JSON.stringify(e)),!0}catch(e){return!1}},e.prototype.handleMessage=function(e){if(this.checkEventOrigin(e.origin,e.source)){var t=e.message?"message":"data";if("string"!=typeof e[t])return;e[t].slice(0,this.secret.length)===this.secret&&this.callListener(JSON.parse(e[t].slice(this.secret.length)))}},e.prototype.checkEventOrigin=function(e,t){return e===this.targetOrigin&&t===this.target},e.prototype.callListener=function(e){for(var t=this.messageListener.length,s=0;s<t;s++)this.messageListener[s].apply(void 0,e)},e}();e.default=n})(),i.default})()));